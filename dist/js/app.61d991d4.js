(function(t){function e(e){for(var i,o,c=e[0],s=e[1],u=e[2],d=0,p=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i]);l&&l(e);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},a=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=s;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"3c56":function(t,e,n){"use strict";var i=n("f898"),r=n.n(i);r.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-app-bar",{attrs:{app:"",color:"red",dark:""}},[n("div",{staticClass:"d-flex align-center ml-4"},[n("h1",[t._v("Looper")])]),n("v-row",[n("v-slider",{staticClass:"ml-auto mr-4 speed-slider",attrs:{"hide-details":"",min:"50",max:"2000",label:"Speed"},model:{value:t.playbackSpeed,callback:function(e){t.playbackSpeed=e},expression:"playbackSpeed"}}),n("v-btn",{staticClass:"mx-4",attrs:{color:"dark"},on:{click:t.toggleState}},[t._v(" "+t._s(t.buttonText)+" ")]),n("v-btn",{staticClass:"mr-8",attrs:{color:"dark"},on:{click:t.onClickReset}},[t._v(" Reset ")])],1)],1),n("v-main",{staticClass:"align-center justify-center"},[n("Sequencer")],1)],1)},a=[],o=n("5530"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[t.audioCtx?n("v-row",{staticClass:"d-flex flex-column align-center"},[n("div",{staticClass:"sequencer__playhead"}),t._l(t.tracks,(function(e,i){return n("div",{key:i},[n("Track",{attrs:{track:e,audioCtx:t.audioCtx,position:t.currentStep}})],1)}))],2):t._e()],1)},s=[],u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["track",{"track--disabled":!t.enabled}]},[n("v-switch",{staticClass:"mx-4",attrs:{inset:"",color:"deep-purple"},model:{value:t.enabled,callback:function(e){t.enabled=e},expression:"enabled"}}),t._l(t.steps,(function(e,i){return n("div",{key:i},[n("Step",{attrs:{step:e,index:i,position:t.position}})],1)})),n("v-slider",{staticClass:"mx-4 track__slider",attrs:{"hide-details":"",min:"0",max:"100","track-color":"deep-purple lighten-5",color:"deep-purple"},model:{value:t.track.volume,callback:function(e){t.$set(t.track,"volume",e)},expression:"track.volume"}})],2)},l=[],d=(n("a630"),n("d81d"),n("a9e3"),n("d3b7"),n("3ca3"),n("ddb0"),n("2f62")),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{class:["step",{"step--active":t.isActive,"step--current":t.isCurrent}],on:{click:t.ToggleStep}})},f=[],v={name:"Step",props:{step:Object,index:Number,position:Number},data:function(){return{isActive:!1}},computed:{isCurrent:function(t){return t.index==t.position}},methods:{ToggleStep:function(){this.isActive=!this.isActive,this.step.active=this.isActive},resetStep:function(){this.isActive=!1,this.step.active=!1}},mounted:function(){this.$root.$on("reset",this.resetStep)}},m=v,b=(n("8af5"),n("2877")),h=Object(b["a"])(m,p,f,!1,null,"02a73f40",null),g=h.exports,k={name:"Track",props:{track:Object,position:Number,audioCtx:null},data:function(){return{enabled:!0,volume:10,audioSrc:null,audioBuffer:null,gainNode:null}},components:{Step:g},computed:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["numberOfSteps"])),{},{steps:function(t){var e=Array.from(Array(t.numberOfSteps).keys());return e.map((function(){return{active:!1}}))},currentVolume:function(t){return t.track.volume/100}}),mounted:function(){this.loadSound(),this.$root.$on("reset",this.resetTrack)},watch:{position:function(t){this.steps[t]["active"]&&this.playSound()},currentVolume:function(t){console.log("volume is now",t),this.gainNode.gain.value=t}},methods:{loadSound:function(){var t=this,e=t.audioCtx,n=new XMLHttpRequest;n.open("GET",t.track.source,!0),n.responseType="arraybuffer",t.gainNode=e.createGain(),t.gainNode.gain.value=t.currentVolume;var i=function(e){t.audioBuffer=e},r=function(t){console.log("Error with decoding audio data"+t.err,t)};n.onload=function(){var t=n.response;e.decodeAudioData(t,i,r)},n.send()},resetTrack:function(){this.enabled=!0},playSound:function(){if(this.enabled&&this.audioBuffer){var t=this.audioCtx,e=this.audioSrc;e=t.createBufferSource(),e.buffer=this.audioBuffer,e.connect(this.gainNode),this.gainNode.connect(t.destination),e.start(0)}}}},S=k,y=(n("cdcd"),n("6544")),x=n.n(y),O=n("ba0d"),w=n("b73d"),j=Object(b["a"])(S,u,l,!1,null,"12921ffc",null),C=j.exports;x()(j,{VSlider:O["a"],VSwitch:w["a"]});var T={name:"Sequencer",data:function(){return{audioCtx:null,ticks:0,interval:null}},components:{Track:C},computed:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["isRunning","tracks","numberOfSteps","speed"])),{},{currentStep:function(t){return t.ticks%t.numberOfSteps},buttonText:function(t){return t.isRunning?"Stop":"Start"}}),methods:{startPlaying:function(){var t=this;this.ticks=0,this.interval=setInterval((function(){t.ticks++}),this.speed)},stopPlaying:function(){this.ticks=0,clearInterval(this.interval)}},mounted:function(){this.audioCtx=new AudioContext,console.log("now creating it!",this.audioCtx)},watch:{isRunning:function(t){console.log("updated to ",t),t?this.startPlaying():this.stopPlaying()},speed:function(){this.isRunning&&(clearInterval(this.interval),this.startPlaying())}},destroyed:function(){clearInterval(this.interval)}},_=T,P=(n("3c56"),n("a523")),A=n("0fd9"),R=Object(b["a"])(_,c,s,!1,null,null,null),V=R.exports;x()(R,{VContainer:P["a"],VRow:A["a"]});var $={name:"App",components:{Sequencer:V},computed:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["isRunning","speed"])),{},{playbackSpeed:{set:function(t){this.$store.commit("updateSpeed",t)},get:function(){return this.speed}},buttonText:function(t){return t.isRunning?"Stop":"Play"}}),methods:Object(o["a"])(Object(o["a"])({},Object(d["b"])(["togglePlaying","reset","initTracks","updateSpeed"])),{},{toggleState:function(){this.togglePlaying(!this.isRunning)},onClickReset:function(){this.reset(),this.$root.$emit("reset")},updateSpeedVar:function(){document.documentElement.style.setProperty("--speed","".concat(this.speed/1e3,"s"))}}),mounted:function(){this.initTracks(),this.updateSpeedVar(),window.AudioContext=window.AudioContext||window.webkitAudioContext},watch:{speed:function(){this.updateSpeedVar()}}},N=$,B=(n("5c0b"),n("7496")),E=n("40dc"),M=n("8336"),q=n("f6c4"),I=Object(b["a"])(N,r,a,!1,null,null,null),G=I.exports;x()(I,{VApp:B["a"],VAppBar:E["a"],VBtn:M["a"],VMain:q["a"],VRow:A["a"],VSlider:O["a"]});var J=n("f309");i["a"].use(J["a"]);var L=new J["a"]({});n("99af");i["a"].use(d["a"]);var D=new d["a"].Store({state:{isRunning:!1,numberOfSteps:8,numberOfTracks:8,bank:1,speed:500,tracks:[]},mutations:{initTracks:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&(t.bank=e);var n=Array.from(Array(t.numberOfTracks).keys());t.tracks=n.map((function(e){return{source:"./banks/".concat(t.bank,"/").concat(e+1,".wav"),volume:80}}))},togglePlaying:function(t,e){t.isRunning=e},resetProperties:function(t){t.isRunning=!1},updateSpeed:function(t,e){t.speed=e}},actions:{initTracks:function(t,e){t.commit("initTracks",e)},togglePlaying:function(t,e){t.commit("togglePlaying",e)},reset:function(t){t.commit("resetProperties"),t.commit("initTracks",1)},updateSpeed:function(t,e){t.commit("updateSpeed",e)}},getters:{isRunning:function(t){return t.isRunning},numberOfSteps:function(t){return t.numberOfSteps},numberOfTracks:function(t){return t.numberOfTracks},speed:function(t){return t.speed},tracks:function(t){return t.tracks}}});i["a"].config.productionTip=!1,new i["a"]({vuetify:L,store:D,render:function(t){return t(G)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var i=n("9c0c"),r=n.n(i);r.a},"6e14":function(t,e,n){},"86d2":function(t,e,n){},"8af5":function(t,e,n){"use strict";var i=n("6e14"),r=n.n(i);r.a},"9c0c":function(t,e,n){},cdcd:function(t,e,n){"use strict";var i=n("86d2"),r=n.n(i);r.a},f898:function(t,e,n){}});
//# sourceMappingURL=app.61d991d4.js.map